{% extends "exmo2010/base_site.html" %}
{% comment %}
# This file is part of EXMO2010 software.
# Copyright 2010 Al Nikolov
# Copyright 2010 Institute for Information Freedom Development
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
{% endcomment %}
{% load table_header i18n get_object_by_pk break in_group adminmedia %}
{% block breadcrumbs %}
<div class="breadcrumbs"><a href="{% url exmo.exmo2010.views.monitoring_list %}">{% trans 'Home' %}</a>&rsaquo;
<a href="{% url exmo.exmo2010.views.monitoring_list %}">{% trans 'Monitoring' %}</a>&rsaquo;
<a href="{% url exmo.exmo2010.views.organization_list task.monitoring.pk %}">{{ task.monitoring.type }}</a>&rsaquo;
<a href="{% url exmo.exmo2010.views.tasks_by_monitoring_and_organization task.monitoring.pk, task.organization.pk %}">{{ task.organization.name }}</a>&rsaquo;
{{title}}
{% endblock %}
{% block extrastyle %}{{ block.super }}<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}exmo2010/score_list.css" />{% endblock %}
{% block content %}
<div id=score_list>
<h2><a href="{{task.organization.url}}">{{task.organization.name}}</a>{% if task.openness %}&nbsp;&mdash;&nbsp;{% trans 'Openness: ' %}{{ task.openness }}{% endif %}</h2>

{% if user.is_superuser or user|in_group:"experts" %}
<div id=csv>
   <a href="{% url exmo.exmo2010.views.task_export task.pk %}">{% trans "Export task CSV" %}</a>
   <form action="{% url exmo.exmo2010.views.task_import task.pk %}" method="POST" enctype="multipart/form-data">
     <input type="file" name="taskfile">
     <input type="submit" value="{% trans "Import task CVS" %}">
   </form>
   {% if importLog %}<div>{{importLog}}</div>{% endif %}
</div>
{% endif %}
<table>
{% table_header headers %}
<tbody>
        {%for category in categories%}

{%for object in object_list%}{%if object.group.group == category%}
            <tr id='parameter_{{category.code}}'><td colspan=10>{{category}}</td></tr>
{{ forloop|break }}
{%endif%}{%endfor%}

            {%for subcategory in subcategories%}
            {%if subcategory.group == category%}

{%for object in object_list%}{%if object.group == subcategory%}
                <tr id='parameter_{{subcategory.fullcode}}'><td colspan=10>{{subcategory}}</td></tr>
{{ forloop|break }}
{%endif%}{%endfor%}

                {%for object in object_list%}{%if object.group == subcategory%}
      <tr width=100% id='parameter_{{object.fullcode}}'>
      <td width=4%>{{ object.fullcode }}</td>
      <td>
      {% if user|in_group:'experts' and task.open or user.is_superuser %}
       {% if object.status %}
        <a href="{% url exmo.exmo2010.views.score_detail_direct object.status,'update' %}?{{request.GET.urlencode}}">{{ object.name }}</a>
       {% else %}
        <a href="{% url exmo.exmo2010.views.score_detail task.pk object.pk %}?{{request.GET.urlencode}}">{{ object.name }}</a>
       {% endif %}
       {% if user.is_superuser %}
            &nbsp;<a href="{% url exmo.exmo2010.views.parameter_manager task.pk, object.pk,'update' %}?{{ request.GET.urlencode }}"><img src="{% admin_media_prefix %}img/admin/icon_changelink.gif" ></a>&nbsp;
            <a href="{% url exmo.exmo2010.views.parameter_manager task.pk, object.pk,'delete' %}?{{ request.GET.urlencode }}"><img src="{% admin_media_prefix %}img/admin/icon_deletelink.gif"></a>
       {% endif %}
      {% else %}
       {% if object.status %}
         <a href="{% url exmo.exmo2010.views.score_detail_direct object.status,'view' %}?{{request.GET.urlencode}}">{{ object.name }}</a>
       {% endif %}
      {% endif %}
      </td>
      {%if object.status%}
      {%get_object_by_pk exmo2010.Score object.status as score %}
      <td width=55px
        {%if score.found == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}>
      {{score.found}}
      </td>
      <td width=55px
      {%if score.complete %}
        {%if score.complete == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.complete %}{{score.complete}}{%else%}&nbsp;{%endif%}
      </td>
      <td width=55px
      {%if score.topical %}
        {%if score.topical == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.topical %}{{score.topical}}{%else%}&nbsp;{%endif%}
      </td>
      <td width=55px
      {%if score.accessible %}
        {%if score.accessible == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.accessible %}{{score.accessible}}{%else%}&nbsp;{%endif%}
      </td>
      <td width=55px
      {%if score.hypertext != None %}
        {%if score.hypertext == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.hypertext != None %}{{score.hypertext}}{%else%}&nbsp;{%endif%}
      </td>
      <td width=55px
      {%if score.document != None %}
        {%if score.document == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.document != None %}{{score.document}}{%else%}&nbsp;{%endif%}
      </td>
      <td width=55px
      {%if score.image != None %}
        {%if score.image == 0 %}
          class="score-ok-zero"
        {%else%}
          class="score-ok-nonzero"
        {%endif%}
      {% else %}
      class="score-none"
      {% endif %}>
      {%if score.image != None %}{{score.image}}{%else%}&nbsp;{%endif%}
      </td>
      {%else%}
        <td colspan=7></td>
      {%endif%}
      <td width=6%>
       {% if user.is_superuser or user|in_group:"experts" %}
        {%if object.status %}<a href="{% url exmo.exmo2010.views.score_detail_direct object.status,'delete' %}?{{request.GET.urlencode}}" class="deletelink">{% trans "Delete" %}</a>
        {% else %}&nbsp;
        {% endif %}
       {% else %}
        {%if object.status %}<a href="{% url exmo.exmo2010.views.add_comment object.pk %}">{% trans "Comment" %}</a>{% endif %}
       {% endif %}
      </td>
      </tr>
    {% endif %}
    {% endfor %}
    {%endif%}{%endfor%}
        {%endfor%}
    </tbody></table>
</div><br>
{% endblock %}
{% block footer %}{% include "exmo2010/footer.html" %}{% endblock %}
