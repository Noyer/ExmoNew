{% extends "exmo2010/base_site.html" %}
{% comment %}
# This file is part of EXMO2010 software.
# Copyright 2010, 2011 Al Nikolov
# Copyright 2010, 2011, 2012 Institute for Information Freedom Development
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
{% endcomment %}

{% load i18n %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}admin/css/forms.css"/>
{% endblock %}

{% block content %}
    <h1>{% trans 'Log in the system' %}</h1>
    {% if request.user.is_authenticated %}
    <p>{% trans 'You are already logged in' %}.</p>
    {% url auth_logout as auth_logout_url %}
    <p>{% blocktrans %}If you really want to log in again, please <a href="{{ auth_logout_url }}">log out</a> first{% endblocktrans %}.</p>
    {% else %}
    <div id="content-main">
        <form action="" method="post">
            {% csrf_token %}
            <div>
                {% if form.non_field_errors %}
                    <ul class="errorlist">
                        {% for error in form.non_field_errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
                <span class="fc_item_header">{% trans 'E-mail or username' %}</span>
                <div>
                    {% if form.username.errors %}
                        <ul class="errorlist">
                            {% for error in form.username.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if form.username.help_text %}
                        <span>{{ form.username.help_text }}</span><br>
                    {% endif %}
                    <div class="fc_field_header">{{ form.username }}</div>
                </div>
                <span class="fc_item_header">{% trans 'Password' %}</span>
                <div>
                    {% if form.password.errors %}
                        <ul class="errorlist">
                            {% for error in form.password.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if form.password.help_text %}
                        <span>{{ form.password.help_text }}</span><br>
                    {% endif %}
                    <div class="fc_field_header">{{ form.password }}</div>
                </div>
            </div>
            <a href="{% url exmo2010:auth_password_reset %}">{% trans 'Forgot your password' %}?</a>
            <input type="submit" value="{% trans 'Log in' %}"/><br/>
        </form>
    </div>
    <script type="text/javascript">
        document.getElementById('id_username').focus()
    </script>
    {% endif %}
{% endblock %}
