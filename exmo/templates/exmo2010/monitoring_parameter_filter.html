{% extends "exmo2010/base_site.html" %}
{% comment %}
# This file is part of EXMO2010 software.
# Copyright 2010, 2011 Al Nikolov
# Copyright 2010, 2011, 2012 Institute for Information Freedom Development
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
{% endcomment %}
{% load i18n adminmedia %}
{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{{STATIC_URL}}admin/css/forms.css" />
{% endblock %}
{% block extrahead %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}exmo2010/js/jquery/jquery.min.js"></script>
    <script>
        $(function () {
            if ({{ hide }})
            {
            $("#ftable tr:gt(0)").hide();
            $("#fbutton").attr('disabled', 'disabled');
            }
            else
            {
                $.ajax({
                    url:"/exmo2010/get_pc/",
                    type:"POST",
                    async:false,
                    data:{p_id: $("#id_parameter").val()}
                }).done(function (data) {
                            $.each(data, function(index, value) {
                                $("#ftable tr:eq("+value+")").hide();
                            });
                        });
            }
        });

        $("#id_parameter").live('change', function () {
            $("#parameter_filter_result").remove();
            var par_val = $("#id_parameter").val();
            $("#form").get(0).reset();
            $("#id_parameter").val(par_val);
            if ($("#id_parameter").val()=='')
            {
                $("#ftable tr:gt(0)").hide();
                $("#fbutton").attr('disabled', 'disabled');
            }
            else
            {
                $("#ftable tr").show();
                $.ajax({
                    url:"/exmo2010/get_pc/",
                    type:"POST",
                    async:false,
                    data:{p_id: $("#id_parameter").val()}
                }).done(function (data) {
                            $.each(data, function(index, value) {
                                $("#ftable tr:eq("+value+")").hide();
                            });
                        });

                $("#fbutton").removeAttr('disabled');
            }
        });
    </script>
{% endblock %}
{% block breadcrumbs %}
<div class="breadcrumbs"><a href="/">{% trans "Home" %}</a>&rsaquo;
<a href="{% url exmo2010:monitoring_list %}">{% trans 'Monitoring' %}</a>&rsaquo;
{% trans 'Parameter-criteria filter' %}
</div>
{% endblock %}

{% block pretitle %}
{% include "exmo2010/monitoring_utility.html" %}
{% endblock %}

{% block content %}
<div id=parameter_filter_form>
<form id="form" method="post" action="">
    {% csrf_token %}
    <table id="ftable">
    {{ form.as_table }}
    </table>
    <input id="fbutton" type="submit" value="{% trans 'Filter' %}"/>
</form>
</div>
{% if object_list %}
<div id=parameter_filter_result>
<table>
 <thead>
  <tr><td>{% trans 'Task' %}</td><td>{% trans 'Score' %}</td></tr>
 </thead>
{% for object in object_list %}
 <tbody>
  <tr>
    <td><a href="{% url exmo2010:score_list_by_task object.task.pk %}">{{ object.task }}</a></td>
    <td><a href="{% url exmo2010:score_view object.pk %}">{{ object.parameter }}</a></td>
  </tr>
{% endfor %}
 </tbody>
</table>
</div>
{% endif %}
{% endblock %}
